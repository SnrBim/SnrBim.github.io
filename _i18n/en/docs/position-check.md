# Position Check
{: .no_toc }

<details open markdown="block">
  <summary>
    Table of contents
  </summary>
  {: .text-delta }
1. TOC
{:toc}
</details>

Command tracks changes in equipment positions and sizes within spaces between two model snapshots, generating a detailed Excel report to determine if lighting recalculation is needed.

## What the Command Does

- Collects all equipment families (size > 100 mm) from current project and linked files
- Groups equipment by spaces (MEP Spaces)
- Compares current state with previous report (if specified)
- Determines change types: new elements, deleted, moved, size changed
- Tracks changes in space parameters (area, perimeter)
- Generates Excel report with two sheets: summary by spaces and detail by elements
- Shows who last edited each element

## Preparation

**Requirements:**
- Project must contain MEP Spaces
- Equipment families must have maximum dimension greater than 100 mm
- For change tracking: previous report generated by this command

**Recommendations:**
- Ensure all spaces are correctly placed and have area
- For first run, previous report is not required — a baseline snapshot will be created

## Usage

1. Launch **Position Check** command from BIMTools panel
2. In the opened window, specify file paths:
   - **Previous Report**: path to previous Excel report *(optional, leave empty for first run)*
   - **New Report Path**: path and filename for new Excel report *(required)*
3. Use **Browse...** buttons to select files through dialog
4. Click **Run** button (or press Enter)
5. Wait for analysis completion — progress bar will show space processing
6. After completion, open the generated Excel file

## Results

Command creates Excel file with two sheets:

### "Summary" Sheet

Contains information for each space:

| Column | Description | Example |
|--------|-------------|---------|
| **Space** | Space name (clickable link to details) | "Office 101" |
| **Area (m²)** | Space area in square meters | 42.5 |
| **Perimeter (m)** | Space perimeter in meters | 26.3 |
| **Status** | Change status | "Equipment changed" |
| **Changed Count** | Number of changed elements | 3 |
| **Sample Items** | First 5 changed elements | "Lamp_01, Lamp_02, Socket_03" |
| **Deltas** | Movement distances in meters | "0.5, 0.3, 1.2" |

**Space statuses:**
- `Unchanged` — no changes
- `Equipment changed` — equipment changed
- `Space changed` — space parameters changed
- `Space and equipment changed` — both changed

### "Detail" Sheet

Contains detailed information for each element:

| Column | Description |
|--------|-------------|
| **Space** | Space name (clickable link to summary) |
| **Model** | Model name (current document or linked file) |
| **Element Id** | Element identifier in Revit |
| **Element Name** | Element name |
| **Category** | Element category |
| **Old X/Y/Z (m)** | Previous position in meters |
| **New X/Y/Z (m)** | Current position in meters |
| **Delta (m)** | Movement distance |
| **Old Size (m)** | Previous size (W × H × D) |
| **New Size (m)** | Current size (W × H × D) |
| **Status** | Change type: New, Deleted, Moved, SizeChanged, Unchanged |
| **Last Changed By** | Last editor name *(workshared projects only)* |

**Sorting:** Elements within each space are sorted by movement distance (descending).

**Navigation:** All space names are hyperlinks for quick navigation between Summary and Detail sheets.

## Features

**Change detection threshold:**
- Movement is detected when displacement exceeds 50 mm (0.05 m)
- Size change is detected when difference exceeds 50 mm

**Element size:**
- Only elements with maximum dimension greater than 100 mm are tracked
- Small elements (fasteners, hardware) are not included

**Unique identification:**
- Each element is identified by combination of model name and Element ID
- This allows correct tracking of elements from different linked files

## Known Limitations

- Command tracks only elements with insertion point (`LocationPoint`), linear elements (`LocationCurve`) are not included
- Elements outside spaces are not included in report
- To get last editor information, project must be workshared
- On first run (without previous report), all elements will be marked as `New`
- Space collection from linked models is disabled (can be enabled if needed)

