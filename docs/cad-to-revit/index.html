

<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet">

  <style id="jtd-nav-activation">
  

    .site-nav > ul.nav-list:first-child > li > a,
    
    .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a,
    .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a {
      background-image: none;
    }

    .site-nav > ul.nav-list:not(:first-child) a,
    .site-nav li.external a {
      background-image: none;
    }

    .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > a {
      font-weight: 600;
      text-decoration: none;
    }.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg,
    .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(1) > button svg {
      transform: rotate(-90deg);
    }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list,
    .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list {
      display: block;
    }
  </style>

  

  
    <script src="/assets/js/vendor/lunr.min.js"></script>
    <script src="/assets/js/vendor/lunr.stemmer.support.min.js"></script>
    <script src="/assets/js/vendor/lunr.es.min.js"></script>
    <script src="/assets/js/vendor/lunr.multi.min.js"></script>
  

  <script src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/assets/images/favicon.png" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cad to Revit | Sener BimTools Docs</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Cad to Revit" />
<meta property="og:locale" content="en" />
<meta name="description" content="This tool is designed to automatically create and update Revit family instances based on blocks from DWG files. It allows you to significantly speed up the process of transferring data from 2D drawings to a 3D model and keep it up to date." />
<meta property="og:description" content="This tool is designed to automatically create and update Revit family instances based on blocks from DWG files. It allows you to significantly speed up the process of transferring data from 2D drawings to a 3D model and keep it up to date." />
<link rel="canonical" href="https://snrbim.github.io/docs/cad-to-revit/" />
<meta property="og:url" content="https://snrbim.github.io/docs/cad-to-revit/" />
<meta property="og:site_name" content="Sener BimTools Docs" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cad to Revit" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"This tool is designed to automatically create and update Revit family instances based on blocks from DWG files. It allows you to significantly speed up the process of transferring data from 2D drawings to a 3D model and keep it up to date.","headline":"Cad to Revit","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://snrbim.github.io/assets/images/logo.png"}},"url":"https://snrbim.github.io/docs/cad-to-revit/"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  
    <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/" class="site-title lh-tight"><img src="/assets/images/logo.png" width="56">
<pre> </pre>
<span class="fs-4">Sener BimTools Docs</span>
</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>

  <nav aria-label="Main" id="site-nav" class="site-nav">
  
  
    <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Common category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/docs/1Common.html" class="nav-list-link">Common</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/cad-to-revit/" class="nav-list-link">Cad to Revit</a></li><li class="nav-list-item"><a href="/docs/change-level/" class="nav-list-link">Change level</a></li><li class="nav-list-item"><a href="/docs/create-along-path/" class="nav-list-link">Create along path</a></li><li class="nav-list-item"><a href="/docs/create-hangers/" class="nav-list-link">Create hangers</a></li><li class="nav-list-item"><a href="/docs/create-print-set/" class="nav-list-link">Create print set</a></li><li class="nav-list-item"><a href="/docs/create-worksets-from-excel/" class="nav-list-link">Create worksets from Excel</a></li><li class="nav-list-item"><a href="/docs/edit-elements-in-excel/" class="nav-list-link">Edit elements in Excel</a></li><li class="nav-list-item"><a href="/docs/fill-code/" class="nav-list-link">Fill code</a></li><li class="nav-list-item"><a href="/docs/history/" class="nav-list-link">History</a></li><li class="nav-list-item"><a href="/docs/info/" class="nav-list-link">Info</a></li><li class="nav-list-item"><a href="/docs/position-check/" class="nav-list-link">Position check</a></li><li class="nav-list-item"><a href="/docs/purge/" class="nav-list-link">Purge</a></li><li class="nav-list-item"><a href="/docs/read-parameters-from-excel/" class="nav-list-link">Read parameters from Excel</a></li><li class="nav-list-item"><a href="/docs/set-project-params/" class="nav-list-link">Set project params</a></li><li class="nav-list-item"><a href="/docs/show-cads/" class="nav-list-link">Show CADs</a></li><li class="nav-list-item"><a href="/docs/sync-space-params/" class="nav-list-link">Sync space params</a></li><li class="nav-list-item"><a href="/docs/tag-elements-on-views/" class="nav-list-link">Tag elements on views</a></li><li class="nav-list-item"><a href="/docs/textomorph/" class="nav-list-link">TextoMorph</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in MEC category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/docs/2MEC.html" class="nav-list-link">MEC</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/assign-equip-to-schematic/" class="nav-list-link">Assign equip to schematic</a></li><li class="nav-list-item"><a href="/docs/assign-spaces-to-equipment/" class="nav-list-link">Assign spaces to equipment</a></li><li class="nav-list-item"><a href="/docs/create-dampers/" class="nav-list-link">Create dampers</a></li><li class="nav-list-item"><a href="/docs/pid-linker/" class="nav-list-link">P&ID Linker</a></li><li class="nav-list-item"><a href="/docs/set-ashrae-code/" class="nav-list-link">Set ASHRAE code</a></li><li class="nav-list-item"><a href="/docs/sync-air-flow-to-schematic/" class="nav-list-link">Sync air flow to schematic</a></li><li class="nav-list-item"><a href="/docs/sync-equip-to-schematic/" class="nav-list-link">Sync equip to schematic</a></li><li class="nav-list-item"><a href="/docs/sync-fire-alarm-diagram/" class="nav-list-link">Sync fire alarm diagram</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in ELE category" aria-pressed="false">
        <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
      </button><a href="/docs/3ELE.html" class="nav-list-link">ELE</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/assign-circuit-to-conduits/" class="nav-list-link">Assign circuit to conduits</a></li><li class="nav-list-item"><a href="/docs/circuit-description/" class="nav-list-link">Circuit description</a></li><li class="nav-list-item"><a href="/docs/cloneshift/" class="nav-list-link">Clone&Shift</a></li><li class="nav-list-item"><a href="/docs/conduit-circuit-sync/" class="nav-list-link">Conduit circuit sync</a></li><li class="nav-list-item"><a href="/docs/convert-lines-to-wires/" class="nav-list-link">Convert lines to wires</a></li><li class="nav-list-item"><a href="/docs/count-sockets/" class="nav-list-link">Count sockets</a></li><li class="nav-list-item"><a href="/docs/create-sockets/" class="nav-list-link">Create sockets</a></li><li class="nav-list-item"><a href="/docs/sync-power-params/" class="nav-list-link">Sync power params</a></li><li class="nav-list-item"><a href="/docs/transfer-lighting-data-to-space/" class="nav-list-link">Transfer Lighting Data To Space</a></li></ul></li></ul>
  
</nav>




  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  
  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Sener BimTools Docs" aria-label="Search Sener BimTools Docs" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/SnrBim/BimTools/releases" class="site-button"
          
          target="_blank" rel="noopener noreferrer"
          
        >
          Downloads
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="toggleTheme" class="site-button"
          
          target="_blank" rel="noopener noreferrer"
          
        >
          üåô
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="langEn" class="site-button"
          
          target="_blank" rel="noopener noreferrer"
          
        >
          EN
        </a>
      </li>
    
      <li class="aux-nav-list-item">
        <a href="langEs" class="site-button"
          
          target="_blank" rel="noopener noreferrer"
          
        >
          ES
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

    <div class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
    <li class="breadcrumb-nav-list-item"><a href="/docs/1Common.html">Common</a></li>
    <li class="breadcrumb-nav-list-item"><span>Cad to Revit</span></li>
  </ol>
</nav>


      <div id="main-content" class="main-content">
        <main>
          
            <h1 class="no_toc" id="cadtorevit-place-and-sync-family-instances-from-cad-blocks">
  
  
    <a href="#cadtorevit-place-and-sync-family-instances-from-cad-blocks" class="anchor-heading" aria-labelledby="cadtorevit-place-and-sync-family-instances-from-cad-blocks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CadToRevit: Place and Sync Family Instances from CAD Blocks
  
  
</h1>
    

<details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#key-features" id="markdown-toc-key-features">Key Features</a></li>
  <li><a href="#workflow" id="markdown-toc-workflow">Workflow</a>    <ol>
      <li><a href="#step-1-preparation-and-analysis-button-prepareupdate" id="markdown-toc-step-1-preparation-and-analysis-button-prepareupdate">Step 1: Preparation and Analysis (button ‚ÄúPrepare/Update‚Ä¶‚Äù)</a></li>
      <li><a href="#step-2-configure-mapping" id="markdown-toc-step-2-configure-mapping">Step 2: Configure Mapping</a></li>
      <li><a href="#step-3-create-elements-button-create-families" id="markdown-toc-step-3-create-elements-button-create-families">Step 3: Create Elements (button ‚ÄúCreate Families‚Äù)</a></li>
    </ol>
  </li>
  <li><a href="#ui-overview" id="markdown-toc-ui-overview">UI Overview</a></li>
  <li><a href="#updating-and-synchronization" id="markdown-toc-updating-and-synchronization">Updating and Synchronization</a></li>
  <li><a href="#placement-height-logic-offset-z" id="markdown-toc-placement-height-logic-offset-z">Placement Height Logic (Offset Z)</a></li>
  <li><a href="#additional-features-and-important-notes" id="markdown-toc-additional-features-and-important-notes">Additional Features and Important Notes</a></li>
</ol>

</details>

<p>This tool is designed to automatically create and update Revit family instances based on blocks from DWG files. It allows you to significantly speed up the process of transferring data from 2D drawings to a 3D model and keep it up to date.</p>
<h2 id="key-features">
  
  
    <a href="#key-features" class="anchor-heading" aria-labelledby="key-features"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Key Features
  
  
</h2>
    

<ul>
  <li><strong>Batch creation and updating:</strong> Fast processing of a large number of blocks.</li>
  <li><strong>Flexible mapping:</strong> Configure the correspondence between CAD blocks and Revit families using Excel.</li>
  <li><strong>Height control:</strong> Precise control over the placement height using multiple levels of settings.</li>
  <li><strong>Duplicate handling:</strong> Intelligent filtering of duplicate blocks.</li>
  <li><strong>Detailed reports:</strong> Generation of Excel reports on created, updated, and skipped elements.</li>
</ul>
<h2 id="workflow">
  
  
    <a href="#workflow" class="anchor-heading" aria-labelledby="workflow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Workflow
  
  
</h2>
    
<h3 id="step-1-preparation-and-analysis-button-prepareupdate">
  
  
    <a href="#step-1-preparation-and-analysis-button-prepareupdate" class="anchor-heading" aria-labelledby="step-1-preparation-and-analysis-button-prepareupdate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 1: Preparation and Analysis (button ‚ÄúPrepare/Update‚Ä¶‚Äù)
  
  
</h3>
    

<p>At this stage, the tool analyzes the selected DWG files and the current Revit project, and then creates or updates the Excel mapping file. This file contains not only the configuration table but also several helper sheets.</p>

<p><strong>Main configuration sheet:</strong></p>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">Block-Family Mapping</code>:</strong> This is the main worksheet where you manually define which CAD block corresponds to which Revit family.</li>
</ul>

<p><strong>Helper sheets (read-only):</strong></p>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">Blocks</code>:</strong> Contains a complete list of all unique blocks found in the specified DWG files, their counts, and all their attributes. Use it as a reference to copy the exact block names for mapping.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">Families</code></strong> and <strong><code class="language-plaintext highlighter-rouge">Families (Transposed)</code>:</strong> Two sheets representing the same data in different formats. They list all compatible families found in the Revit project and their writable parameters. They help in choosing the correct family and parameter names for mapping.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">Comparison</code>:</strong> Shows the changes in the block composition (added, removed, modified) between the last two analysis runs.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">Duplicates</code>:</strong> Provides detailed information about all found duplicate blocks, indicating which one was used and which were ignored.</li>
</ul>
<h3 id="step-2-configure-mapping">
  
  
    <a href="#step-2-configure-mapping" class="anchor-heading" aria-labelledby="step-2-configure-mapping"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 2: Configure Mapping
  
  
</h3>
    

<p>Edit the <strong><code class="language-plaintext highlighter-rouge">Block-Family Mapping</code></strong> sheet, filling in at least the three mandatory columns: <code class="language-plaintext highlighter-rouge">BlockName</code>, <code class="language-plaintext highlighter-rouge">FamilyName</code>, <code class="language-plaintext highlighter-rouge">FamilyType</code>.</p>
<h3 id="step-3-create-elements-button-create-families">
  
  
    <a href="#step-3-create-elements-button-create-families" class="anchor-heading" aria-labelledby="step-3-create-elements-button-create-families"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Step 3: Create Elements (button ‚ÄúCreate Families‚Äù)
  
  
</h3>
    

<p>After configuring the mapping, start the creation process. The tool will place families in the model according to your rules and generate a final Excel report.</p>
<h2 id="ui-overview">
  
  
    <a href="#ui-overview" class="anchor-heading" aria-labelledby="ui-overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UI Overview
  
  
</h2>
    

<p><img src="image.png" alt="UI" /></p>

<ul>
  <li><strong>Input Fields:</strong> A large text box for DWG file paths (you can paste multiple paths, each on a new line) and a field for the Excel mapping file path.</li>
  <li><strong>‚Äú‚Ä¶‚Äù Menu Buttons</strong>: To the right of each input field, there is a <code class="language-plaintext highlighter-rouge">...</code> button that opens a menu on a <strong>left-click</strong>:
    <ul>
      <li><strong>For DWG:</strong>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">Add new path(s)...</code>: Opens a dialog to select DWG files.</li>
          <li><code class="language-plaintext highlighter-rouge">Recent Files</code>: Shows a list of recently used files for quick access.</li>
        </ul>
      </li>
      <li><strong>For Excel:</strong>
        <ul>
          <li><code class="language-plaintext highlighter-rouge">Select new path...</code>: Opens a dialog to select an Excel file.</li>
          <li><code class="language-plaintext highlighter-rouge">Generate default path</code>: <strong>Automatically creates a path</strong> for the mapping file in the plugin‚Äôs reports folder (<code class="language-plaintext highlighter-rouge">%AppData%\Sener\BimTools\Reports\CadToRevit\</code>). The file will be named <code class="language-plaintext highlighter-rouge">mapping_&lt;project_name&gt;.xlsx</code>.</li>
          <li><code class="language-plaintext highlighter-rouge">Recent Files</code>: A list of recent mapping files.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>Hotkeys:</strong>
    <ul>
      <li><strong>Enter</strong>: Starts the family creation process (<code class="language-plaintext highlighter-rouge">Create Families</code>).</li>
      <li><strong>Esc</strong>: Closes the window (<code class="language-plaintext highlighter-rouge">Cancel</code>).</li>
    </ul>
  </li>
</ul>
<h2 id="updating-and-synchronization">
  
  
    <a href="#updating-and-synchronization" class="anchor-heading" aria-labelledby="updating-and-synchronization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Updating and Synchronization
  
  
</h2>
    

<p>When run again, the tool does not recreate elements but updates existing ones by tracking changes.</p>

<ul>
  <li><strong>Link:</strong> The tool tracks the created elements using the <strong>‚ÄúDWG info‚Äù</strong> service parameter, which is written to each family. <strong>Do not delete or modify this parameter.</strong></li>
  <li><strong>Change Detection:</strong> Synchronization is triggered if there are changes in:
    <ul>
      <li><strong>Position:</strong> The element‚Äôs offset exceeds 100 mm.</li>
      <li><strong>Rotation:</strong> The rotation angle has changed by more than 0.1¬∞.</li>
      <li><strong>Parameters:</strong> The value of at least one of the tracked parameters has changed.</li>
    </ul>
  </li>
  <li><strong>‚ÄúOrphaned‚Äù Elements:</strong> If a block has been deleted from the DWG, the corresponding element in Revit is not deleted but is marked in the report as ‚ÄúOrphaned‚Äù. This allows for a manual decision on deletion.</li>
</ul>
<h2 id="placement-height-logic-offset-z">
  
  
    <a href="#placement-height-logic-offset-z" class="anchor-heading" aria-labelledby="placement-height-logic-offset-z"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Placement Height Logic (Offset Z)
  
  
</h2>
    

<p>The element‚Äôs height is determined by a three-level priority system:</p>

<ol>
  <li><strong><code class="language-plaintext highlighter-rouge">offset</code> attribute in CAD block (Highest priority):</strong> If the block has an <code class="language-plaintext highlighter-rouge">offset</code> attribute, its value is used for the height. Values &gt; 5 are considered millimeters; ‚â§ 5 are considered meters.</li>
  <li><strong><code class="language-plaintext highlighter-rouge">DefaultZ (mm)</code> column in Excel (Medium priority):</strong> If the attribute is not present, the value from this column is used.</li>
  <li><strong>Default by category (Lowest priority):</strong> If nothing is specified, the default height for the family‚Äôs category is applied:
    <ul>
      <li><strong>Lighting Fixtures</strong> (<code class="language-plaintext highlighter-rouge">OST_LightingFixtures</code>): <code class="language-plaintext highlighter-rouge">2999 mm</code></li>
      <li><strong>Lighting Devices</strong> (<code class="language-plaintext highlighter-rouge">OST_LightingDevices</code>): <code class="language-plaintext highlighter-rouge">999 mm</code></li>
      <li><strong>All other categories:</strong> <code class="language-plaintext highlighter-rouge">99 mm</code></li>
    </ul>
  </li>
</ol>
<h2 id="additional-features-and-important-notes">
  
  
    <a href="#additional-features-and-important-notes" class="anchor-heading" aria-labelledby="additional-features-and-important-notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Additional Features and Important Notes
  
  
</h2>
    

<ul>
  <li><strong>Working with Views and Cropping:</strong> The tool processes not just linked DWG files from the link manager, but their specific <strong>instances placed on views</strong> (primarily floor plans). This is a key mechanism for correctly correlating coordinates when a single DWG file contains multiple floor plans offset from each other.
    <ul>
      <li><strong>Your Action:</strong> Before running the tool, you must <strong>manually place and align</strong> each instance of the linked DWG on the corresponding plan view in Revit.</li>
      <li><strong>Tool‚Äôs Action:</strong> The tool reads the transformation (offset and rotation) of each instance and correctly calculates the block positions in the shared Revit coordinate system.</li>
      <li><strong>Filtering:</strong> Additionally, you will have to use the <strong>Crop Box</strong> on the view to limit processing to only the desired part of the DWG. Blocks outside the crop box will be ignored for that level.</li>
      <li><strong>Verification:</strong> You can check if your setup is correct on the <strong><code class="language-plaintext highlighter-rouge">Blocks</code></strong> sheet in the Excel file. For each block, it shows the number of its occurrences on each view (in ‚ÄúView: <View Name="">" columns). If the count does not match your expectations, check the alignment and crop boundaries of the DWG link.</View></li>
    </ul>
  </li>
  <li><strong>‚ÄúCorner‚Äù Mode:</strong> If you specify ‚ÄúCorner‚Äù in the <code class="language-plaintext highlighter-rouge">OffsetX</code> or <code class="language-plaintext highlighter-rouge">OffsetY</code> columns, the offset will be automatically calculated as half the family‚Äôs width/length. This is useful for elements that are inserted by their corner, not their center.</li>
  <li><strong>Unit Recognition:</strong> When transferring numeric parameters, the tool automatically recognizes and converts values with suffixes such as <code class="language-plaintext highlighter-rouge">kW</code>, <code class="language-plaintext highlighter-rouge">MW</code>, <code class="language-plaintext highlighter-rouge">W</code>, <code class="language-plaintext highlighter-rouge">V</code>, <code class="language-plaintext highlighter-rouge">kV</code>, <code class="language-plaintext highlighter-rouge">kg</code>.</li>
  <li><strong>Backups:</strong> Before modifying your Excel mapping file, the tool automatically creates a full copy of it with a timestamp. The files are saved in the folder: <code class="language-plaintext highlighter-rouge">%AppData%\Sener\BimTools\Reports\CadToRevit\Backups\</code>.</li>
  <li><strong>Comments in DWG Paths:</strong> In the tool‚Äôs window, you can paste a list of paths to DWG files. Lines starting with a <code class="language-plaintext highlighter-rouge">;</code> symbol will be ignored, allowing you to temporarily disable files from processing.</li>
  <li><strong>Caution with Manual Copying:</strong> When you copy a family instance created by this tool, you also copy its ‚ÄúDWG info‚Äù service parameter. This creates a duplicate link, and during the next sync, the tool will <strong>silently update only the original instance</strong>, ignoring all copies.
    <ul>
      <li><strong>Recommendation:</strong> Do not copy elements managed by this tool. If you need a ‚Äúdumb‚Äù copy, be sure to clear the value of its ‚ÄúDWG info‚Äù parameter to break the link.</li>
      <li><em>Note: In the future, this behavior is planned to be improved so that the tool itself updates the link (based on location) and reports such collisions.</em></li>
    </ul>
  </li>
</ul>

          

          
            
          
        </main>
        

  <hr>
  <footer>
    
      <p><a href="#top" id="back-to-top">Back to top</a></p>
    

    <script>

  function initDocumentFilter() {
    const checkboxes = document.querySelectorAll('.filter-checkbox');
    const docList = document.getElementById('doc-list');
    if (!(docList && checkboxes.length > 0)) return;

    const listItems = docList.getElementsByTagName('li');

    function filterDocs() {
      const checkedGroups = Array.from(checkboxes)
        .filter(i => i.checked)
        .map(i => i.value);
      for (const item of listItems) {
        const itemGroup = item.getAttribute('data-group');
        item.style.display = checkedGroups.length === 0 ||
                             checkedGroups.includes(itemGroup)
        ? ''
        : 'none';
      }
    }

    checkboxes.forEach(checkbox => {
      checkbox.addEventListener('change', filterDocs);
    });

  }

  function initThemeToggle() {
    const toggleElem = document.querySelector('a[href*="toggleTheme"]');
    if (!toggleElem) return;

    function applyTheme(theme) {
      jtd.setTheme(theme);
      localStorage.setItem('jtd-theme', theme);
      toggleElem.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    }

    toggleElem.addEventListener('click', function(e) {
      e.preventDefault();
      const newTheme = jtd.getTheme() === 'dark' ? 'light' : 'dark';
      applyTheme(newTheme);
    });

    const savedTheme = localStorage.getItem('jtd-theme');
    if (savedTheme) {
      jtd.setTheme(savedTheme);
    }
    toggleElem.textContent = jtd.getTheme() === 'dark' ? '‚òÄÔ∏è' : 'üåô';
  }

  function initLangSwither() {
    const langEnLink = document.querySelector('a[href*="langEn"]');
    const langEsLink = document.querySelector('a[href*="langEs"]');

    const languageLinks = [];
    if (langEnLink) languageLinks.push(langEnLink);
    if (langEsLink) languageLinks.push(langEsLink);

    if (languageLinks.length === 0) return;

    const defaultLang = 'en'; // Assuming 'en' is the default language

    languageLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        
        let targetLang;
        if (this.href.includes('langEn')) {
          targetLang = 'en';
        } else if (this.href.includes('langEs')) {
          targetLang = 'es';
        }

        if (!targetLang) return; // Do nothing if language is not determined

        let currentPathname = window.location.pathname;

        // Remove existing language prefix if present
        const langRegex = /^\/(en|es)(\/|$)/; // Only 'en' and 'es'
        let pathWithoutLang = currentPathname.replace(langRegex, '/');

        // Ensure pathWithoutLang starts with a single slash
        if (!pathWithoutLang.startsWith('/')) {
          pathWithoutLang = '/' + pathWithoutLang;
        }

        let newPathname;
        if (targetLang === defaultLang) {
          newPathname = pathWithoutLang;
        } else {
          // Add new language prefix
          newPathname = `/${targetLang}${pathWithoutLang}`;
        }

        // Handle root path specifically
        if (pathWithoutLang === '/' && targetLang !== defaultLang) {
          newPathname = `/${targetLang}/`;
        } else if (pathWithoutLang === '/' && targetLang === defaultLang) {
          newPathname = '/';
        }

        // Construct full URL
        const newUrl = window.location.origin + newPathname + window.location.search;
        window.location.href = newUrl;
      });
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    initDocumentFilter();
    initThemeToggle();
    initLangSwither();
  });
</script>


    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
</body>
</html>

